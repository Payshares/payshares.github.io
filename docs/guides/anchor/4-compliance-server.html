<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <!--

  Want to contribute to this site? Take a look at the GitHub repository for this
  site: https://github.com/payshares/developers

  -->
  <title>Compliance Server | Payshares Developers</title>
  <!-- <meta name="viewport" content="width=device-width, initial-scale=1"> -->
  <meta name="author" content="Payshares.org and contributors">

  <meta property="og:title" content="Compliance Server | Payshares Developers">
  <meta property="og:type" content="website">


  <link rel="stylesheet" href="/styles/index-642cd6cc68250700f4daa5029026a066.css">

  <link rel="apple-touch-icon" sizes="144x144" href="/images/favicon/rocket-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/images/favicon/rocket-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/rocket-180x180.png">
  <link rel="icon" type="image/png" href="/images/favicon/rocket-96x96.png" sizes="96x96">
  <meta name="msapplication-TileImage" content="/images/favicon/rocket-144x144.png">

  <script type="text/javascript">
    var $mcGoal = {'settings':{'uuid':'c001d97369b7a10d224c23867','dc':'us9'}};
    (function() {
      var sp = document.createElement('script'); sp.type = 'text/javascript'; sp.async = true; sp.defer = true;
      sp.src = ('https:' == document.location.protocol ? 'https://s3.amazonaws.com/downloads.mailchimp.com' : 'http://downloads.mailchimp.com') + '/js/goal.min.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(sp, s);
    })();
  </script>

  <script>window.clientData = {};</script>

  <script type="text/javascript">
  setTimeout(function(){var a=document.createElement("script");
  var b=document.getElementsByTagName("script")[0];
  a.async=true;a.type="text/javascript";b.parentNode.insertBefore(a,b)}, 1);
  </script>
</head>
<body>
<div class="header2016">
  <div class="header2016__logo header2016__logo--spaced">
    <div class="so-siteHeader">
      <span class="so-logo">
  <a href="https://www.payshares.org/" class="so-logo__main">Payshares</a><!--
  --><span class="so-logo__separator"> </span><!--
  --><a href="/" class="so-logo__subSite">developers</a>
</span>
    </div>
  </div>
  <nav class="header2016__nav mainNavMenu spu-padStart-30">
    <a class="mainNavMenu__item is-currentItem" href="/guides/">Guides</a>
<a class="mainNavMenu__item " href="/reference/">API Reference</a>
<a class="mainNavMenu__item " href="/software/">Software</a>
<a class="mainNavMenu__item " href="/tools/">Tools</a>
  </nav>
</div>

<div class="S-flex-row">
  <div class="siteSidebar pageNavListBounder">
  <div class="mainSidebar">
    <ul class="pageNavList">

      <li class="pageNavList__subList">
        <span class="pageNavList__title">Get Started</span>
        <ol class="collapsibleListSet__list">
                    <li class="pageNavList__item"><a href="/guides/get-started/index.html">Payshares Network Overview</a></li>
          <li class="pageNavList__item"><a href="/guides/get-started/create-account.html">Create an Account</a></li>
  <li class="pageNavList__item"><a href="/guides/get-started/transactions.html">Send and Receive Money</a></li>

        </ol>
      </li>
    


      <li class="pageNavList__subList">
        <span class="pageNavList__title">Become an Anchor</span>
        <ol class="collapsibleListSet__list">
                    <li class="pageNavList__item"><a href="/guides/anchor/index.html">Architecture</a></li>
          <li class="pageNavList__item"><a href="/guides/anchor/2-bridge-server.html">Bridge Server</a></li>
  <li class="pageNavList__item"><a href="/guides/anchor/3-federation-server.html">Federation Server</a></li>
  <li class="pageNavList__item is-currentItem"><a href="/guides/anchor/4-compliance-server.html">Compliance Server</a></li>
  <li class="pageNavList__item"><a href="/guides/anchor/5-conclusion.html">Next Steps</a></li>

        </ol>
      </li>
    
      
      <li class="pageNavList__subList">
        <span class="pageNavList__title">Concepts</span>
        <ul class="collapsibleListSet__list">
              <li class="pageNavList__item"><a href="/guides/concepts/accounts.html">Accounts</a></li>
  <li class="pageNavList__item"><a href="/guides/concepts/assets.html">Assets</a></li>
  <li class="pageNavList__item"><a href="/guides/concepts/exchange.html">Distributed Exchange</a></li>
  <li class="pageNavList__item"><a href="/guides/concepts/federation.html">Federation</a></li>
  <li class="pageNavList__item"><a href="/guides/concepts/fees.html">Fees</a></li>
  <li class="pageNavList__item"><a href="/guides/concepts/inflation.html">Inflation</a></li>
  <li class="pageNavList__item"><a href="/guides/concepts/ledger.html">Ledger</a></li>
  <li class="pageNavList__item"><a href="/guides/concepts/list-of-operations.html">List of Operations</a></li>
  <li class="pageNavList__item"><a href="/guides/concepts/multi-sig.html">Multisignature</a></li>
  <li class="pageNavList__item"><a href="/guides/concepts/operations.html">Operations</a></li>
  <li class="pageNavList__item"><a href="/guides/concepts/scp.html">Payshares Consensus Protocol</a></li>
  <li class="pageNavList__item"><a href="/guides/concepts/stellar-toml.html">Payshares.toml</a></li>
  <li class="pageNavList__item"><a href="/guides/concepts/test-net.html">Testnet</a></li>
  <li class="pageNavList__item"><a href="/guides/concepts/transactions.html">Transactions</a></li>
  <li class="pageNavList__item"><a href="/guides/concepts/versioning.html">Versioning and Upgrading</a></li>
  <li class="pageNavList__item"><a href="/guides/concepts/xdr.html">XDR</a></li>

        </ul>
      </li>
    
        <li class="pageNavList__item"><a href="/guides/attachment.html">Payshares Attachment Convention</a></li>
  <li class="pageNavList__item"><a href="/guides/channels.html">Channels</a></li>
  <li class="pageNavList__item"><a href="/guides/compliance-protocol.html">Compliance Protocol</a></li>
  <li class="pageNavList__item"><a href="/guides/issuing-assets.html">Issuing Assets</a></li>
  <li class="pageNavList__item"><a href="/guides/security.html">Security</a></li>
  <li class="pageNavList__item"><a href="/guides/things-to-build.html">Build Payshares Apps</a></li>
        <li class="pageNavList__item"><a href="/guides/contributing.html">Contribution Guide</a></li>
    </ul>
  </div>
</div>
  <div class="S-flexItem-share">
  <div class="spu-padSE-30">
    <h1 class="mainSectionTitle">
      Compliance Server
      
    </h1>
  </div>
  <div class="S-flex-rowWrap spu-borderTop-1 spu-borderColor-neutral7">
    <s-read-md class="S-flexItem-share mainContent s-read-md--capped spu-padSE-30 spu-padTB-20 documentRead" link-process-md>
      <p>The task of an anchor is handling regulatory compliance, like Anti-Money Laundering (<abbr title="Anti-Money Laundering">AML</abbr>). To accomplish that, you should use the <a href="../compliance-protocol.html">Payshares compliance protocol</a>, a standard way to exchange compliance information and pre-approve a transaction with another financial institution.</p>
<p>You can write your own server that matches the compliance protocol, but <a href="http://Payshares.org">Payshares.org</a> also provides a <a href="https://github.com/payshares/bridge-server/blob/master/readme_compliance.md">compliance server</a> that takes care of most of the work for you.</p>
<p>Your bridge server contacts your compliance server in order to authorize a transaction before sending it. Your compliance server uses the compliance protocol to clear the transaction with the recipient&#x2019;s compliance server, then lets the bridge server know the transaction is ok to send.</p>
<figure><img src="assets/anchor-send-payment-compliance.png" alt></figure>
<p>When another compliance server contacts yours to clear a transaction, a series of callbacks are used to check the information with you. Later, when your bridge server receives a transaction, it contacts your compliance server to verify that it was cleared.</p>
<figure><img src="assets/anchor-receive-payment-compliance.png" alt></figure>
<h2 id="create-a-database"><a class="anchorShortcut" href="#create-a-database" aria-hidden="true"></a> Create a Database</h2>
<p>The compliance server requires a MySQL or PostgreSQL database in order to save transaction and compliance information. Create a new database named <code>payshares_compliance</code> and a user to manage it. You don&#x2019;t need to add any tables; the server includes <a href="#start-the-server">a command to configure and update your database</a>.</p>
<h2 id="download-and-configure-compliance-server"><a class="anchorShortcut" href="#download-and-configure-compliance-server" aria-hidden="true"></a> Download and Configure Compliance Server</h2>
<p>Start by <a href="https://github.com/payshares/bridge-server/releases">downloading the latest compliance server</a> for your platform and install the executable anywhere you like. In the same directory, create a file named <code>config_compliance.toml</code>. This will store the configuration for the compliance server. It should look something like:</p>
<code-example name="config_compliance.toml">
<pre><code class="language-toml">external_port = 8003
internal_port = 8004
# Set this to `true` if you need to check the information of a person receiving
# a payment you are sending (if false, only the sender will be checked). For
# more information, see the callbacks section below.
needs_auth = false
network_passphrase = &quot;Test SDF Network ; September 2015&quot;

[database]
type = &quot;mysql&quot; # Or &quot;postgres&quot; if you created a PostgreSQL database
url = &quot;dbuser:dbpassword@/payshares_compliance&quot;

[keys]
# This should be the secret seed for your base account (or another account that
# can authorize transactions from your base account).
signing_seed = &quot;SAV75E2NK7Q5JZZLBBBNUPCIAKABN64HNHMDLD62SZWM6EBJ4R7CUNTZ&quot;
encryption_key = &quot;SAV75E2NK7Q5JZZLBBBNUPCIAKABN64HNHMDLD62SZWM6EBJ4R7CUNTZ&quot;

[callbacks]
sanctions = &quot;http://localhost:8005/compliance/sanctions&quot;
ask_user = &quot;http://localhost:8005/compliance/ask_user&quot;
fetch_info = &quot;http://localhost:8005/compliance/fetch_info&quot;

# The compliance server must be available via HTTPS. Specify your SSL
# certificate and key here. If the server is behind a proxy or load  balancer
# that implements HTTPS, you can omit this section.
[tls]
certificate_file = &quot;server.crt&quot;
private_key_file = &quot;server.key&quot;
</code></pre>
</code-example>
<p>The configuration file lists both an <code>external_port</code> and an <code>internal_port</code>. The external port must be publicly accessible. This is the port that other organizations will contact in order to determine whether you will accept a payment.</p>
<p>The internal port should <em>not</em> be publicly accessible. It is the port through which you initiate compliance operations and transmit private information. It&#x2019;s up to you to keep this port secure through a firewall, a proxy, or some other means.</p>
<p>You&#x2019;ll also need to tell your bridge server that you now have a compliance server it can use. Update <a href="2-bridge-server.html#download-and-configure-bridge-server"><code>config_bridge.toml</code></a> with the address of your compliance server&#x2019;s <em>internal</em> port:</p>
<code-example name="config_bridge.toml">
<pre><code class="language-toml">port = 8001
horizon = &quot;https://horizon-testnet.payshares.org&quot;
network_passphrase = &quot;Test SDF Network ; September 2015&quot;
compliance = &quot;https://your_org.com:8004&quot;

# ...the rest of your configuration...
</code></pre>
</code-example>
<h2 id="implement-compliance-callbacks"><a class="anchorShortcut" href="#implement-compliance-callbacks" aria-hidden="true"></a> Implement Compliance Callbacks</h2>
<p>In the server configuration file, there are three callback URLs, much like those for the bridge server. They are HTTP POST URLs that will be sent form-encoded data:</p>
<ul>
<li>
<p><code>fetch_info</code> is sent a federation address (like <code>tunde_adebayo*your_org.com</code>) and should return all the information necessary for another organization to perform compliance checks. It can be any data you deem reasonable and must be formatted as JSON.</p>
<p>When you are sending a payment, it will be called to get information on the customer who is sending the payment in order to send it to the receiving organization. When receiving a payment, it will be called if the sending organization has requested information on the receiver to do its own compliance checks (based on the <a href="#download-and-configure-compliance-server"><code>needs_auth</code> configuration</a>).</p>
  <code-example name="Implementing the fetch_info callback">
<pre><code class="language-js">app.post(&apos;/compliance/fetch_info&apos;, function (request, response) {
  var addressParts = response.body.address.split(&apos;*&apos;);
  var friendlyId = addressParts[0];

  // You need to create `accountDatabase.findByFriendlyId()`. It should look
  // up a customer by their Payshares account and return account information.
  accountDatabase.findByFriendlyId(friendlyId)
    .then(function(account) {
      // This can be any data you determine is useful and is not limited to
      // these three fields.
      response.json({
        name: account.fullName,
        address: account.address,
        date_of_birth: account.dateOfBirth
      });
      response.end();
    })
    .catch(function(error) {
      console.error(&apos;Fetch Info Error:&apos;, error);
      response.status(500).end(error.message);
    });
});
</code></pre>
<pre><code class="language-java">@POST
@Path(&quot;compliance/fetch_info&quot;)
@Consumes(MediaType.APPLICATION_FORM_URLENCODED)
@Produces(MediaType.APPLICATION_JSON)
public Response fetchInfo(
  @FormParam(&quot;address&quot;) String address) {

  String friendlyId = address.split(&quot;\\*&quot;, 2)[0];

  // You need to create `accountDatabase.findByFriendlyId()`. It should
  // find customers by their Payshares account and return account information.
  try {
    Account account = accountDatabase.findByFriendlyId(friendlyId);
    return Response.ok(
      // This can be any data you determine is useful and is not limited to
      // these three fields.
      Json.createObjectBuilder()
        .add(&quot;name&quot;, account.fullName)
        .add(&quot;address&quot;, account.address)
        .add(&quot;date_of_birth&quot;, account.dateOfBirth)
        .build())
      .build();
    )
  } catch (Exception error) {
    System.out.println(
      String.format(&quot;Could not find account: %s&quot;, address));
    return Response.status(500).entity(error.getMessage()).build();
  }
}
</code></pre>
  </code-example>
</li>
<li>
<p><code>sanctions</code> is given information about the person who is sending a payment to you or one of your customers. This is the same data the sending server would have received from its own <code>fetch_info</code> callback. The HTTP response code it produces indicates whether the payment will be accepted (status <code>200</code>), denied (status <code>403</code>), or if you need additional time for processing (status <code>202</code>).</p>
  <code-example name="Implementing the sanctions callback">
<pre><code class="language-js">app.post(&apos;/compliance/sanctions&apos;, function (request, response) {
  var sender = JSON.parse(request.body.sender);

  // You need to create a function to check whether there are any sanctions
  // against someone.
  sanctionsDatabase.isAllowed(sender)
    .then(function() {
      response.status(200).end();
    })
    .catch(function(error) {
      // In this example, we&apos;re assuming `isAllowed` returns an error with a
      // `type` property that indicates the kind of error. Your systems may
      // work differently; just return the same HTTP status codes.
      if (error.type === &apos;DENIED&apos;) {
        response.status(403).end();
      }
      else if (error.type === &apos;UNKNOWN&apos;) {
        // If you need to wait and perform manual checks, you&apos;ll have to
        // create a way to do that as well
        notifyHumanForManualSanctionsCheck(sender);
        // The value for `pending` is a time to check back again in seconds
        response.status(202).json({pending: 3600}).end();
      }
      else {
        response.status(500).end(error.message);
      }
    });
});
</code></pre>
<pre><code class="language-java">import java.io.*;
import javax.json.Json;
import javax.json.JsonObject;
import javax.json.JsonReader;

@POST
@Path(&quot;compliance/sanctions&quot;)
@Consumes(MediaType.APPLICATION_FORM_URLENCODED)
@Produces(MediaType.APPLICATION_JSON)
public Response sanctions(@FormParam(&quot;sender&quot;) String sender) {
  JsonReader jsonReader = Json.createReader(new StringReader(sender));
  JsonObject senderData = jsonReader.readObject();
  jsonReader.close();

  // You need to create a function to check whether there are any sanctions
  // against someone.
  Permission permission = sanctionsDatabase.isAllowed(
    senderData.getString(&quot;name&quot;),
    senderData.getString(&quot;address&quot;),
    senderData.getString(&quot;date_of_birth&quot;));

  // In this example, we&apos;re assuming `isAllowed` returns a Permissions enum
  // that indicates whether someone is Allowed, Denied, or Unknown. Your
  // systems may work differently; just return the same HTTP status codes.
  if (permission.equals(Permission.Allowed)) {
    return Response.ok().build();
  }
  else if (permission.equals(Permission.Denied)) {
    return Response.status(403).build();
  }
  else {
    // If you need to wait and perform manual checks, you&apos;ll have to implent
    // a way to do that as well.
    notifyHumanForManualSanctionsCheck(senderData);
    // The value for `pending` is a time to check back again in seconds.
    return Response.accepted(
      Json.createObjectBuilder()
        .add(&quot;pending&quot;, 3600)
        .build())
      .build();
  }
}
</code></pre>
  </code-example>
</li>
<li>
<p><code>ask_user</code> is called when receiving a payment if the sender has requested information about the receiver. Its return code indicates whether you will send that information (<code>fetch_info</code> is then called to actually <em>get</em> the info). It is sent information on both the payment and the sender.</p>
  <code-example name="Implementing the ask_user callback">
<pre><code class="language-js">app.post(&apos;/compliance/ask_user&apos;, function (request, response) {
  var sender = JSON.parse(request.body.sender);

  // You can do any checks that make sense here. For example, you may not
  // want to share information with someone who has sanctions as above:
  sanctionsDatabase.isAllowed(sender)
    .then(function() {
      response.status(200).end();
    })
    .catch(function(error) {
      if (error.type === &apos;UNKNOWN&apos;) {
        // If you need to wait and perform manual checks, you&apos;ll have to
        // create a way to do that as well.
        notifyHumanForManualInformationSharing(sender);
        // The value for `pending` is a time to check back again in seconds
        response.status(202).json({pending: 3600}).end();
      }
      else {
        response.status(403).end();
      }
    });
});
</code></pre>
<pre><code class="language-java">@POST
@Path(&quot;compliance/ask_user&quot;)
@Consumes(MediaType.APPLICATION_FORM_URLENCODED)
@Produces(MediaType.APPLICATION_JSON)
public Response askUser(@FormParam(&quot;sender&quot;) String sender) {
  JsonReader jsonReader = Json.createReader(new StringReader(sender));
  JsonObject senderData = jsonReader.readObject();
  jsonReader.close();

  // You can do any checks that make sense here. For example, you may not
  // want to share information with someone who has sanctions as above:
  Permission permission = sanctionsDatabase.isAllowed(
    senderData.getString(&quot;name&quot;),
    senderData.getString(&quot;address&quot;),
    senderData.getString(&quot;date_of_birth&quot;));

  if (permission.equals(Permission.Allowed)) {
    return Response.ok().build();
  }
  else if (permission.equals(Permission.Denied)) {
    return Response.status(403).build();
  }
  else {
    // If you need to wait and perform manual checks, you&apos;ll have to create
    // a way to do that as well.
    notifyHumanForManualInformationSharing(senderData);
    // The value for `pending` is a time to check back again in seconds.
    return Response.accepted(
      Json.createObjectBuilder()
        .add(&quot;pending&quot;, 3600)
        .build())
      .build();
  }
}
</code></pre>
  </code-example>
</li>
</ul>
<p>To keep things simple, we&#x2019;ll add all three callbacks to the same server we are using for the bridge server callbacks. However, you can implement them on any service that makes sense in your infrastructure. Just make sure they&#x2019;re reachable at the URLs in your config file.</p>
<h2 id="update-paysharestoml"><a class="anchorShortcut" href="#update-paysharestoml" aria-hidden="true"></a> Update Payshares.toml</h2>
<p>When other organizations need to contact your compliance server to authorize a payment to one of your customers, they consult your domain&#x2019;s <code>payshares.toml</code> file for the address, just as when finding your federation server.</p>
<p>For compliance operations, you&#x2019;ll need to list two new properties in your <code>payshares.toml</code>:</p>
<code-example name="payshares.toml">
<pre><code class="language-toml">FEDERATION_SERVER = &quot;https://www.your_org.com:8002/federation&quot;
AUTH_SERVER = &quot;https://www.your_org.com:8003&quot;
SIGNING_KEY = &quot;GAIGZHHWK3REZQPLQX5DNUN4A32CSEONTU6CMDBO7GDWLPSXZDSYA4BU&quot;
</code></pre>
</code-example>
<p><code>AUTH_SERVER</code> is the address for the <em>external</em> port of your compliance server. Like your federation server, this can be any URL you like, but <strong>it must support HTTPS and use a valid SSL certificate.</strong><sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup></p>
<p><code>SIGNING_KEY</code> is the public key that matches the secret seed specified for <code>signing_seed</code> in your compliance server&#x2019;s configuration. Other organizations will use it to verify that messages were actually sent by you.</p>
<h2 id="start-the-server"><a class="anchorShortcut" href="#start-the-server" aria-hidden="true"></a> Start the Server</h2>
<p>Before starting the server the first time, the tables in your database need to be created. Running compliance server with the <code>--migrate-db</code> argument will make sure everything is set to go:</p>
<pre><code class="language-bash">./compliance --migrate-db
</code></pre>
<p>Each time you update the compliance server to a new version, you should run this command again. It will upgrade your database in case anything needs to be changed.</p>
<p>Now that your database is fully set up, you can start the compliance server by running:</p>
<pre><code class="language-bash">./compliance
</code></pre>
<h2 id="try-it-out"><a class="anchorShortcut" href="#try-it-out" aria-hidden="true"></a> Try It Out</h2>
<p>Now that you&#x2019;ve got your compliance server set up and ready to verify transactions, you&#x2019;ll want to test it by sending a payment to someone who is running their own compliance and federation servers.</p>
<p>The easiest way to do this is to simply test a payment from one of your own customers to another. Your compliance, federation, and bridge servers will perform both the sending and receiving sides of the transaction.</p>
<p>Send a payment through your bridge server, but this time, use federated addresses for the sender and receiver and an <code>extra_memo</code><sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup> to trigger compliance checks:</p>
<code-example name="Send a Payment">
<pre><code class="language-bash"># NOTE: `extra_memo` is required for compliance (use it instead of `memo`)
curl -X POST -d \
&quot;amount=1&amp;\
asset_code=USD&amp;\
asset_issuer=GAIUIQNMSXTTR4TGZETSQCGBTIF32G2L5P4AML4LFTMTHKM44UHIN6XQ&amp;\
destination=amy*your_org.com&amp;\
source=SAV75E2NK7Q5JZZLBBBNUPCIAKABN64HNHMDLD62SZWM6EBJ4R7CUNTZ&amp;\
sender=tunde_adebayo*your_org.com&amp;\
extra_memo=Test%20transaction&quot; \
http://localhost:8001/payment
</code></pre>
<pre><code class="language-js">var request = require(&apos;request&apos;);

request.post({
  url: &apos;http://localhost:8001/payment&apos;,
  form: {
    amount: &apos;1&apos;,
    asset_code: &apos;USD&apos;,
    asset_issuer: &apos;GAIUIQNMSXTTR4TGZETSQCGBTIF32G2L5P4AML4LFTMTHKM44UHIN6XQ&apos;,
    destination: &apos;amy*your_org.com&apos;,
    source: &apos;SAV75E2NK7Q5JZZLBBBNUPCIAKABN64HNHMDLD62SZWM6EBJ4R7CUNTZ&apos;,
    sender: &apos;tunde_adebayo*your_org.com&apos;,
    // `extra_memo` is required for compliance (use it instead of `memo`)
    extra_memo: &apos;Test transaction&apos;,
  }
}, function(error, response, body) {
  if (error || response.statusCode !== 200) {
    console.error(&apos;ERROR!&apos;, error || body);
  }
  else {
    console.log(&apos;SUCCESS!&apos;, body);
  }
});
</code></pre>
<pre><code class="language-java">import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.HttpClients;
import org.apache.http.message.BasicNameValuePair;
import org.apache.http.util.EntityUtils;

import java.util.ArrayList;
import java.util.List;

public class PaymentRequest() {
  public static void main(String [] args) {
    HttpPost paymentRequest = new HttpPost(&quot;http://localhost:8001/payment&quot;);

    List&lt;NameValuePair&gt; params = new ArrayList&lt;NameValuePair&gt;();
    params.add(new BasicNameValuePair(&quot;amount&quot;, &quot;1&quot;));
    params.add(new BasicNameValuePair(&quot;asset_code&quot;, &quot;USD&quot;));
    params.add(new BasicNameValuePair(&quot;asset_issuer&quot;, &quot;GAIUIQNMSXTTR4TGZETSQCGBTIF32G2L5P4AML4LFTMTHKM44UHIN6XQ&quot;));
    params.add(new BasicNameValuePair(&quot;destination&quot;, &quot;amy*your_org.com&quot;));
    params.add(new BasicNameValuePair(&quot;source&quot;, &quot;SAV75E2NK7Q5JZZLBBBNUPCIAKABN64HNHMDLD62SZWM6EBJ4R7CUNTZ&quot;));
    params.add(new BasicNameValuePair(&quot;sender&quot;, &quot;tunde_adebayo*your_org.com&quot;));
    // `extra_memo` is required for compliance (use it instead of `memo`)
    params.add(new BasicNameValuePair(&quot;extra_memo&quot;, &quot;Test transaction&quot;));

    HttpResponse response = httpClient.execute(paymentRequest);
    HttpEntity entity = response.getEntity();
    if (entity != null) {
      String body =  EntityUtils.toString(entity);
      System.out.println(body);
    }
  }
}
</code></pre>
</code-example>
<p>For a more realistic test, set up a duplicate copy of your bridge, federation, and compliance servers at a different domain and send a payment to them!</p>
<nav class="sequence-navigation">
  <a rel="prev" href="3-federation-server.html" class="button button--previous">Back: Federation Server</a>
  <a rel="next" href="5-conclusion.html" class="button button--next">Next: Next Steps</a>
</nav>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>Requiring that public services are available via SSL helps keep things secure. While testing, you can get free certificates from <a href="http://letsencrypt.org">http://letsencrypt.org</a>. You can also generate your own self-signed certificates, but you must add them to all the computers in your tests. <a href="#fnref1" class="footnote-backref">&#x21A9;&#xFE0E;</a></p>
</li>
<li id="fn2" class="footnote-item"><p>Compliance transactions with the bridge server don&#x2019;t support the <code>memo</code> field. The actual transaction&#x2019;s <code>memo</code> will store a hash used to verify that the transaction submitted to the Payshares network matches the one agreed upon during initial compliance checks. Your <code>extra_memo</code> data will be transmitted instead during the compliance checks. For details, see <a href="../compliance-protocol.html">the compliance protocol</a>. <a href="#fnref2" class="footnote-backref">&#x21A9;&#xFE0E;</a></p>
</li>
</ol>
</section>

      <br>
      <a href="https://github.com/payshares/docs/blob/master/guides/anchor/4-compliance-server.md" class="spu-color-neutral6">Edit this doc in GitHub</a>
    </s-read-md>
  
  </div>
</div>
</div>

<div class="so-back spu-borderTop-1 spu-borderColor-neutral7 spu-padTB-15">
  <div class="so-chunk">
    <div class="siteFooter">
      <div class="siteFooter__list">
        <a class="siteFooter__list__item" href="https://www.payshares.org/"><span class="graphic-backArrow-9"></span>&#xA0;&#xA0;Payshares.org</a>
        <span class="siteFooter__list__sep">|</span>
        <a class="siteFooter__list__item" href="https://www.payshares.org/bug-bounty-program/">Bug Bounty</a>
        <a class="siteFooter__list__item" href="/payshares-core/software/admin.html">Run a node</a>
        <a class="siteFooter__list__item" href="/guides/things-to-build.html">Build an app</a>
        <a class="siteFooter__list__item" href="https://github.com/payshares/">GitHub</a>
        <a class="siteFooter__list__item" href="http://slack.payshares.org/">Community chat</a>
      </div>
      <div class="siteFooter__list siteFooter__list--aux">
        <a class="siteFooter__list__item siteFooter__list__item--aux" href="https://www.payshares.org/terms-of-service/">Terms of service</a>
        <a class="siteFooter__list__item siteFooter__list__item--aux" href="https://www.payshares.org/privacy-policy/">Privacy policy</a>
      </div>
    </div>
  </div>
</div>
</body>
<script src="/js/app-29e9eab4c89c33d7fb1e0705ca62d0cc.js"></script>
<script type="text/javascript">
!function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="3.1.0";
analytics.load("U8cLXTFMPm");
analytics.page()
}}();
</script>

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5V3WNNP');</script>
<!-- End Google Tag Manager -->

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5V3WNNP" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
</html>
